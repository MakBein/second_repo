# xss_security_gui/deep_crawler.py >>> analyze_csp :
# ะงัะพ ะพะทะฝะฐัะฐะตั csp_risk_level
# | "none" | CSP ะพััััััะฒัะตั โ ัะฐะนั ััะทะฒะธะผ ะบ XSS
# | "weak" | unsafe-inlineunsafe-eval | CSP ะตััั, ะฝะพ ัะพะดะตัะถะธั unsafe-inline ะธะปะธ unsafe-eval โ ัะฐััะธัะฝะฐั ะทะฐัะธัะฐ
# | "moderate"| CSP ะตััั, ะฝะพ ะฑะตะท nonce/strict-dynamic โ ะฑะฐะทะพะฒะฐั ะทะฐัะธัะฐ
# | "strong" |  CSP ะธัะฟะพะปัะทัะตั nonce ะธะปะธ strict-dynamic โ ัะพัะพัะฐั ะทะฐัะธัะฐ ะพั XSS
# ะฟะพะบะฐะทัะตั ะฒัะต ัะฐะนะปั ะฟัะพะตะบัะฐ dir -Recurse
ะกะปะตะดัััะธะน ัะฐะณ
ะขะตะฟะตัั ะผะพะถะตัั ะทะฐะฟัััะธัั ะบัะฐัะปะตั:

python -m xss_security_gui.main crawl https://gazprombank.ru

# xss_security_gui/dom_parser.py
๐งฉ ะกัะตะผะฐ ะฟัะธะผะตะฝะตะฝะธั ะผะตัะพะดะพะฒ DOMParser

crawl_site() โ DOMParser โ ThreatEngine / Threat Intel โ ะฒัะฒะพะด ะฒ GUI

GUI (XSSAnalyzerApp)
   โโโ ะะฝะพะฟะบะธ (build_ui)
         โโโ ๐ธ๏ธ ะัะฐัะปะตั โ run_crawler() โ crawl_site() โ DOMParser.extract_all()
         โ                                      โ
         โ                                      โโโ ThreatEngine + Threat Intel
         โโโ ๐ ะัะฐะบะพะฒะฐัั DOM-ะฒะตะบัะพัั โ ะธัะฟะพะปัะทัะตั ัะตะทัะปััะฐัั DOMParser
         โโโ ๐งช ะคัะทะทะธะฝะณ โ run_fuzzing()
         โโโ ๐ ะััะฐัะพั โ run_mutator()
         โโโ ๐ค ะะฒัะพะฐัะฐะบะฐ โ run_auto_attack()
         โโโ ะญะบัะฟะพัั / ะะพะณะธ

๐ ะะตัะพะดั ะดะปั XSS ะธ ะฑะตะทะพะฟะฐัะฝะพััะธ
- extract_forms() โ ัะพัะผั, ะฟะพะปั, ัะพะฑััะธั โ ะฟะพัะตะฝัะธะฐะปัะฝัะต ัะพัะบะธ ะธะฝัะตะบัะธะธ.
- extract_iframes() โ sandbox ะธ src โ ะพะฑัะพะด ะธะทะพะปััะธะธ, clickjacking.
- extract_dom_events() โ onerror, onload, onclick โ ะฟััะผัะต XSSโััะธะณะณะตัั.
- extract_scripts() โ inline/ะฒะฝะตัะฝะธะต JS โ ะฟะพะธัะบ ะพะฟะฐัะฝัั ััะฝะบัะธะน.
- extract_inline_js() โ ัะธัััะน JSโะบะพะด โ ะฐะฝะฐะปะธะท eval, document.write.
- extract_inline_styles() โ CSSโะฒััะฐะถะตะฝะธั โ CSSโXSS (expression(), url(javascript:)).
- extract_media() โ img, video, audio โ XSS ัะตัะตะท onerror.
- extract_data_attributes() โ data-* โ ัะบััััะต ะดะฐะฝะฝัะต, ัะฐััะพ ะธััะพัะฝะธะบ DOMโXSS.
- extract_svg() โ inlineโSVG โ XSS ัะตัะตะท <script> ะฒะฝัััะธ SVG.
- extract_csp_meta() โ CSPโะฟะพะปะธัะธะบะธ โ ะพัะตะฝะบะฐ ะทะฐัะธัั ะพั XSS.

๐ ะะตัะพะดั ะดะปั SEO ะธ ะบะพะฝัะตะฝัะฐ
- extract_meta_tags() โ name, property, content โ SEO, OpenGraph, Twitter Cards.
- extract_links() โ ะฒัะต <a> โ ััััะบัััะฐ ัััะปะพะบ, ะฟะตัะตะปะธะฝะบะพะฒะบะฐ.
- extract_base_tag() โ <base href> โ ะฒะปะธัะตั ะฝะฐ SEO ะธ ะพัะฝะพัะธัะตะปัะฝัะต ัััะปะบะธ.
- extract_styles() โ CSS โ ะฟัะพะฒะตัะบะฐ inlineโััะธะปะตะน ะธ ะฒะฝะตัะฝะธั ััะธะปะตะน.
- extract_noscript() โ ะบะพะฝัะตะฝั ะดะปั ะฟะพะธัะบะพะฒะธะบะพะฒ ะฑะตะท JS.
- extract_comments() โ ัะบััััะต ะทะฐะผะตัะบะธ ัะฐะทัะฐะฑะพััะธะบะพะฒ, ะธะฝะพะณะดะฐ ะบะปััะธ/ะดะฐะฝะฝัะต.

๐ก ะะตัะพะดั ะดะปั Threat Intel
- extract_forms() โ ัะพัะบะธ ะฐัะฐะบะธ โ Threat Intel ะฐััะตัะฐะบัั.
- extract_iframes() โ ะฒะฝะตัะฝะธะต ัะตััััั โ ะธะฝะดะธะบะฐัะพัั ัะณัะพะท.
- extract_scripts() / extract_inline_js() โ JSโััะฝะบัะธะธ โ ัะธะณะฝะฐัััั ัะบัะฟะปะพะนัะพะฒ.
- extract_data_attributes() โ ัะบััััะต ัะพะบะตะฝั โ ััะตัะบะธ.
- extract_aria_attributes() โ ะดะพัััะฟะฝะพััั โ ะธะฝะพะณะดะฐ ะผะฐัะบะธัะพะฒะบะฐ ะฒัะตะดะพะฝะพัะฝัั ัะปะตะผะตะฝัะพะฒ.
- extract_svg() โ ะฟะพะดะพะทัะธัะตะปัะฝัะต SVG โ ะธะฝะดะธะบะฐัะพัั.
- extract_media() โ ะฒะฝะตัะฝะธะต ัะตััััั โ ััะตะบะธะฝะณ/ัะบััะธะปัััะฐัะธั.
- extract_csp_meta() โ ะฟะพะปะธัะธะบะฐ ะฑะตะทะพะฟะฐัะฝะพััะธ โ ะพัะตะฝะบะฐ ะทัะตะปะพััะธ ะทะฐัะธัั.

๐งฑ ะะตัะพะดั ะดะปั ััััะบัััะฝะพะณะพ ะฐัะดะธัะฐ
- extract_tables() โ ะดะฐะฝะฝัะต ะฒ ัะฐะฑะปะธัะฐั โ ััััะบัััะฝัะน ะฐะฝะฐะปะธะท.
- extract_comments() โ ัะบััััะต ะฟะพะดัะบะฐะทะบะธ โ ะฐััะธัะตะบัััะฝัะน ะฐัะดะธั.
- extract_aria_attributes() โ ะดะพัััะฟะฝะพััั โ UX ะธ compliance.
- extract_base_tag() โ ััััะบัััะฐ ัััะปะพะบ โ ะฐััะธัะตะบัััะฐ ัะฐะนัะฐ.

๐ ะะธะทัะฐะปัะฝะฐั ััะตะผะฐ (ัะฐะฑะปะธัะฐ)
|  |  | 
|  |  | 
|  |  | 
|  |  | 
|  |  | 



ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ัะฒะพะน DOMParser ััะฐะป ัะฝะธะฒะตััะฐะปัะฝัะผ ะธะฝััััะผะตะฝัะพะผ:
- ะดะปั XSSโะฐะฝะฐะปะธะทะฐ ะพะฝ ะพัะฒะฐััะฒะฐะตั ะฒัะต ะฟะพัะตะฝัะธะฐะปัะฝัะต ัะพัะบะธ ะธะฝัะตะบัะธะธ,
- ะดะปั SEO โ ะฒัะต ะบะปััะตะฒัะต ัะตะณะธ,
- ะดะปั Threat Intel โ ะฒัะต ะฐััะตัะฐะบัั,
- ะดะปั ััััะบัััะฝะพะณะพ ะฐัะดะธัะฐ โ ะฐััะธัะตะบัััะฝัะต ัะปะตะผะตะฝัั.

#================================================================

ะฅะพัะพัะพ, ะดะฐะฒะฐะน ัะพะฑะตััะผ ะฟะพัะฐะณะพะฒัะน ัะฐะฑะพัะธะน ััะตะฝะฐัะธะน ะธัะฟะพะปัะทะพะฒะฐะฝะธั ัะฒะพะตะณะพ ะพะฑะฝะพะฒะปัะฝะฝะพะณะพ GUI ั DOMParser. ะญัะพ ะฑัะดะตั ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััั ะดะตะนััะฒะธะน, ะบะพัะพััั ัั ะผะพะถะตัั ัะตะฐะปัะฝะพ ะฒัะฟะพะปะฝะธัั ะฒ ะฟัะพะตะบัะต.

๐งฉ ะัะธะผะตั ัะฐะฑะพัะตะณะพ ััะตะฝะฐัะธั
1. ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั
- ะะฐะฟััะบะฐะตัั main.py โ ะพัะบััะฒะฐะตััั ะพะบะฝะพ XSS Security GUI.
- ะ ะฟะพะปะต ๐ฏ URL / Payload ะฒะฒะพะดะธัั ะฐะดัะตั ัะฐะนัะฐ, ะฝะฐะฟัะธะผะตั:
https://testphp.vulnweb.com/

2. ะัะฐัะปะธะฝะณ ัะฐะนัะฐ
- ะะฐะถะธะผะฐะตัั ะบะฝะพะฟะบั ๐ธ๏ธ ะัะฐัะปะตั.
- ะัะฐัะปะตั ะฟัะพัะพะดะธั ัััะฐะฝะธัั, ัะพััะฐะฝัะตั ะฐััะตัะฐะบัั ะฒ JSON ะธ ะฒัะฒะพะดะธั:
- ะฝะฐะนะดะตะฝะฝัะต ัะพัะผั
- ัััะปะบะธ
- ัะบัะธะฟัั
- ะ ััะพั ะผะพะผะตะฝั DOMParser.extract_all() ัะถะต ัะฐะฑะพัะฐะตั ะฒะฝัััะธ ะบัะฐัะปะตัะฐ ะธ ัะพะฑะธัะฐะตั ััััะบัััั.

3. ะะพะปะฝัะน DOMโะฐะฝะฐะปะธะท
- ะะพัะปะต ะบัะฐัะปะตัะฐ ะถะผััั ะบะฝะพะฟะบั ๐ ะะฝะฐะปะธะท DOM.
- ะ output_box ะฟะพัะฒะธััั ะฟะพะปะฝัะน ะพัััั:
{
  "forms": [...],
  "iframes": [...],
  "meta_tags": [...],
  "dom_events": [...],
  "scripts": [...],
  "links": [...],
  "styles": [...],
  "comments": [...],
  "noscript": [...],
  "csp_meta": [...],
  "base_tag": {...},
  "data_attributes": [...],
  "aria_attributes": [...],
  "svg": [...],
  "tables": [...],
  "media": [...],
  "inline_styles": [...]
}


4. ะัะพะฒะตัะบะฐ XSSโะฒะตะบัะพัะพะฒ
- ะะผััั ะบะฝะพะฟะบั โ๏ธ ะัะพะฒะตัะบะฐ XSSโะฒะตะบัะพัะพะฒ.
- ะ ะพะบะฝะต ะฒัะฒะพะดัััั:
- ะฒัะต onerror, onload, onclick ัะพะฑััะธั
- inlineโJS ะบััะบะธ
- inlineโCSS ััะธะปะธ
- ะญัะพ ะดะฐัั ะฑัััััะน ัะฟะธัะพะบ ะฟะพัะตะฝัะธะฐะปัะฝัั ัะพัะตะบ ะฐัะฐะบะธ.

5. ะะฝะฐะปะธะท ัััะปะพะบ
- ะะผััั ะบะฝะพะฟะบั ๐ ะะฝะฐะปะธะท ัััะปะพะบ.
- ะะธะดะธัั ัะฟะธัะพะบ ะฒัะตั <a href> ะธ ะธั ัะตะบััะพะฒ.
- ะัะปะธ ะตััั <base href>, ะพะฝ ัะพะถะต ะฒัะฒะพะดะธััั.

6. ะะฝะฐะปะธะท ััะธะปะตะน
- ะะผััั ะบะฝะพะฟะบั ๐จ ะะฝะฐะปะธะท ััะธะปะตะน.
- ะะพะปััะฐะตัั ัะฟะธัะพะบ inlineโCSS ะธ ะฟะพะดะบะปัััะฝะฝัั ััะธะปะตะน.

7. ะะฝะฐะปะธะท ะผะตะดะธะฐ
- ะะผััั ะบะฝะพะฟะบั ๐ผ๏ธ ะะฝะฐะปะธะท ะผะตะดะธะฐ.
- ะะธะดะธัั ะฒัะต ะธะทะพะฑัะฐะถะตะฝะธั, ะฒะธะดะตะพ, ะฐัะดะธะพ ั ะธั ะฐััะธะฑััะฐะผะธ.
- ะะพะถะฝะพ ััะฐะทั ะทะฐะผะตัะธัั ะฟะพะดะพะทัะธัะตะปัะฝัะต img src ะฑะตะท alt ะธะปะธ ั onerror.

8. ะััะธะฑััั Data/ARIA
- ะะผััั ะบะฝะพะฟะบั ๐งฉ ะััะธะฑััั Data/ARIA.
- ะะพะปััะฐะตัั ัะฟะธัะพะบ ะฒัะตั data-* ะธ aria-* ะฐััะธะฑััะพะฒ.
- ะญัะพ ะฟะพะผะพะณะฐะตั ะฝะฐะนัะธ ัะบััััะต ะดะฐะฝะฝัะต ะธะปะธ ัะปะตะผะตะฝัั ะดะพัััะฟะฝะพััะธ.

9. ะกะบััััะน ะบะพะฝัะตะฝั
- ะะผััั ะบะฝะพะฟะบั ๐ ะะพะผะผะตะฝัะฐัะธะธ/NoScript.
- ะะธะดะธัั ะฒัะต HTMLโะบะพะผะผะตะฝัะฐัะธะธ ะธ ัะพะดะตัะถะธะผะพะต <noscript>.
- ะะฝะพะณะดะฐ ัะฐะผ ะฑัะฒะฐัั ะฟะพะดัะบะฐะทะบะธ ัะฐะทัะฐะฑะพััะธะบะพะฒ ะธะปะธ ัะบััััะต ะดะฐะฝะฝัะต.

10. ะขะฐะฑะปะธัั ะธ SVG
- ะะผััั ะบะฝะพะฟะบั ๐ ะขะฐะฑะปะธัั ะธ SVG.
- ะะพะปััะฐะตัั ัะฟะธัะพะบ ัะฐะฑะปะธั ั ะธั ัััะพะบะฐะผะธ ะธ inlineโSVG.
- SVG ัะฐััะพ ะธัะฟะพะปัะทัะตััั ะดะปั XSS, ะฟะพััะพะผั ััะพ ะฒะฐะถะฝัะน ะฐะฝะฐะปะธะท.

๐ฏ ะัะพะณ
ะ ััะพะผ ััะตะฝะฐัะธะธ ัั:
- ะะฐะฟัััะธะป ะบัะฐัะปะตั.
- ะะพะปััะธะป ะฟะพะปะฝัะน DOMโะฐะฝะฐะปะธะท.
- ะัะพะณะฝะฐะป ะพัะดะตะปัะฝัะต ะฟัะพะฒะตัะบะธ: XSSโะฒะตะบัะพัั, ัััะปะบะธ, ััะธะปะธ, ะผะตะดะธะฐ, ะฐััะธะฑััั, ัะบััััะน ะบะพะฝัะตะฝั, ัะฐะฑะปะธัั/SVG.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะบะฐะถะดะฐั ััะฝะบัะธั DOMParser ะธัะฟะพะปัะทัะตััั ะฝะฐ 100% ัะตัะตะท ะพัะดะตะปัะฝัะต ะบะฝะพะฟะบะธ ะฒ GUI.


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        XSSSecurityGUI      โ
โ  (main.py, ะบะฝะพะฟะบะธ GUI)     โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ       AttackEngine         โ
โ  - run_auto_attack()       โ
โ  - run_modular_auto_attack() โโโโโโโโโโโโโโ
โ  - _record_result()         โ             โ
โ  - export_results()         โ             โ
โ  - send_summary_to_threat_intel()         โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         ะะพะดัะปะธ ะฐัะฐะบ (attack_launcher.py)   โ
โ  - attack_api_endpoints()                  โ
โ  - brute_force_tokens()                    โ
โ  - attack_parameters()                     โ
โ  - attack_user_ids()                       โ
โ  - attack_xss_targets()                    โ
โ  - build_headers_list()                    โ
โ  - suggest_payloads()                      โ
โ  - mask_secret()                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐งญ ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั
1. ๐ฆ ะะฐะฟััะบ ะฐะฒัะพะฐัะฐะบะธ ะธะท GUI
ะ ะฝะธะถะฝะตะน ะฟะฐะฝะตะปะธ GUI ะฝะฐะถะผะธ:
- ๐งจ ะะฒัะพะฐัะฐะบะฐ โ ะทะฐะฟััะบะฐะตั AttackEngine.run_auto_attack()
- ๐ค ะกะฒะพะดะบะฐ ะฒ Threat Intel โ ะพัะฟัะฐะฒะปัะตั get_summary() ัะตัะตะท send_summary_to_threat_intel()
2. ๐ง ะงัะพ ะดะตะปะฐะตั run_auto_attack()
- ะัะปะธ ะฟะตัะตะดะฐะฝ launcher, ะพะฝ ะธัะฟะพะปัะทัะตััั (ะฝะฐะฟัะธะผะตั, launch_auto_attack)
- ะัะปะธ ะฝะตั โ ะฒัะทัะฒะฐะตััั run_modular_auto_attack(), ะบะพัะพััะน:
- ะัะฟะพะปัะทัะตั ะฒัะต ะผะพะดัะปะธ ะธะท attack_launcher.py
- ะกะพะฑะธัะฐะตั ัะตะทัะปััะฐัั ัะตัะตะท _record_result()
- ะัะฟัะฐะฒะปัะตั ะธั ะฒ Threat Intel
3. ๐งช ะงัะพ ะดะตะปะฐะตั ะบะฐะถะดัะน ะผะพะดัะปั
|  |  |  | 
| attack_api_endpoints |  | List[dict] | 
| brute_force_tokens |  | List[dict] | 
| attack_parameters |  | List[dict] | 
| attack_user_ids |  | List[dict] | 
| attack_xss_targets |  | List[dict] | 


4. ๐งฐ ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ััะฝะบัะธะธ
|  |  | 
| build_headers_list() |  | 
| suggest_payloads() |  | 
| mask_secret() |  | 
| send_request() |  | 



๐ค ะญะบัะฟะพัั ะธ ะพััััะฝะพััั
- ะัะต ัะตะทัะปััะฐัั ัะพััะฐะฝััััั ัะตัะตะท export_results() ะฒ logs/attack_results.json
- ะกะฒะพะดะบะฐ (get_summary()) ัะพะดะตัะถะธั:
- ะะพะป-ะฒะพ ะฐัะฐะบ
- ะะพะป-ะฒะพ high/error
- ะััะฟะฟะธัะพะฒะบั ะฟะพ ัะธะฟะฐะผ
- ะัะตะผะตะฝะฝัั ะผะตัะบั

๐ก๏ธ Threat Intel
- ะะฐะถะดัะน ัะตะทัะปััะฐั ะพัะฟัะฐะฒะปัะตััั ัะตัะตะท _send_intel()
- ะกะฒะพะดะบะฐ ะพัะฟัะฐะฒะปัะตััั ะฒัััะฝัั ะธะปะธ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะตัะตะท send_summary_to_threat_intel()

โ ะฆะตะปั
ะะพะฑะฐะฒะธัั ะฒ GUI:
- ะัะพะณัะตัั-ะฑะฐั ั ะพัะพะฑัะฐะถะตะฝะธะตะผ ะฒัะฟะพะปะฝะตะฝะธั ะผะพะดัะปะตะน ะฐัะฐะบ
- ะะพะณ ะฟะพ ะบะฐะถะดะพะผั ััะฐะฟั
- ะัะธะฝััะพะฝะฝัะน ะทะฐะฟััะบ, ััะพะฑั GUI ะฝะต ะทะฐะฒะธัะฐะป

GUI (PyQt / Tkinter / etc.)
โ
โโโ ะะฝะพะฟะบะฐ "๐งจ ะะฒัะพะฐัะฐะบะฐ"
โ     โโ ะทะฐะฟััะบะฐะตั run_auto_attack_threaded()
โ
โโโ ะัะพะณัะตัั-ะฑะฐั (QProgressBar / ttk.Progressbar)
โ     โโ ะพะฑะฝะพะฒะปัะตััั ะฟะพัะปะต ะบะฐะถะดะพะณะพ ะผะพะดัะปั
โ
โโโ ะะพะณ-ะฒะธะดะถะตั (QTextEdit / Listbox)
      โโ ะฟะพะปััะฐะตั ัะพะพะฑัะตะฝะธั ะธะท log_func

๐งช ะะตะทัะปััะฐั
- GUI ะพััะฐัััั ะพัะทัะฒัะธะฒัะผ
- ะัะพะณัะตัั-ะฑะฐั ะฟะพะบะฐะทัะฒะฐะตั ะฒัะฟะพะปะฝะตะฝะธะต ะบะฐะถะดะพะณะพ ะผะพะดัะปั
- ะะพะณ ะพัะพะฑัะฐะถะฐะตั ััะฐััั, ะพัะธะฑะบะธ, ััะฟะตัะธ
- ะัั ัะฐะฑะพัะฐะตั ะฒ ัะพะฝะต, ะฑะตะท ะฑะปะพะบะธัะพะฒะพะบ


#############################################################

1. ะััะธัะตะบัััะฐ ThreatConnector 5.0
- ThreatBackendBase โ ะฐะฑัััะฐะบัะฝัะน ะฑะฐะทะพะฒัะน ะบะปะฐัั.
- NdjsonBackend โ ัะฒะพะน ัะตะบััะธะน ัะพัะผะฐั (appendโonly).
- SQLiteBackend โ ััะฐะฝะตะฝะธะต ะฐััะตัะฐะบัะพะฒ ะฒ SQLite.
- ElasticSearchBackend โ ะพัะฟัะฐะฒะบะฐ ะฐััะตัะฐะบัะพะฒ ะฒ Elasticsearch ะธะฝะดะตะบั.
- ThreatConnector โ ัะฐัะฐะด, ะบะพัะพััะน ัะฐะฑะพัะฐะตั ัะตัะตะท ะฒัะฑัะฐะฝะฝัะน backend.
- THREAT_CONNECTOR โ ะณะปะพะฑะฐะปัะฝัะน ัะบะทะตะผะฟะปัั, ะบะฐะบ ะธ ัะฐะฝััะต.

3. ะะฐะบ ััะพ ะธัะฟะพะปัะทะพะฒะฐัั ะฒ _run_attack_background
ะะผะฟะพัั ะพััะฐัััั ัะฐะบะธะผ:
from xss_security_gui.threat_analysis.threat_connector import THREAT_CONNECTOR

๎ท๎ท
ะ ะดะฐะปััะต ัั ัะฐะฑะพัะฐะตัั ั ะฝะธะผ ัะฐะบ ะถะต, ะบะฐะบ ัะฐะฝััะต:
THREAT_CONNECTOR.emit(
    module="API Endpoints",
    target=self.domain,
    result={
        "severity": "info",
        "category": "api_endpoints",
        "source": "AutoAttackEngine",
        "items": page_api_endpoints,
    },
)



4. ะะตัะตะบะปััะตะฝะธะต backend'ะฐ
ะงะตัะตะท ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั:
- NDJSON (ะฟะพ ัะผะพะปัะฐะฝะธั):
THREAT_BACKEND=ndjson


- SQLite:
THREAT_BACKEND=sqlite


- Elasticsearch:
THREAT_BACKEND=elastic
THREAT_ES_URL=http://localhost:9200
THREAT_ES_INDEX=threat_intel
THREAT_ES_USER=elastic
THREAT_ES_PASS=changeme

ะะพั ััะตะผะฐ ะฟะพัะพะบะพะฒ ะดะปั ะฒัะตะณะพ ะฟะฐะบะตัะฐ ULTRA 6.0/6.1 โ ััะพะฑั ะฑัะปะพ ะฒะธะดะฝะพ, ะบะฐะบ ะฒะทะฐะธะผะพะดะตะนััะฒััั ะผะพะดัะปะธ 
honeypot_server, honeypot_monitor ะธ deep_analysis_tab:

########################################๐งต ะะฑัะฐั ััะตะผะฐ ะฟะพัะพะบะพะฒ ULTRA######################################


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        ะะปะฐะฒะฝัะน ะฟะพัะพะบ GUI      โ
โ  Tkinter mainloop             โ
โ  โโ DeepAnalysisTab (Frame)   โ
โ     โโ ะพะฑัะฐะฑะพัะบะฐ ัะพะฑััะธะน      โ
โ        (ัะฐะฑะปะธัั, ะบะฝะพะฟะบะธ, UI)  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
              โ ะทะฐะฟััะบะฐะตั ัะพะฝะพะฒัะต ะทะฐะดะฐัะธ
              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ะคะพะฝะพะฒัะต ะฟะพัะพะบะธ GUI-ะฒะบะปะฐะดะบะธ  โ
โ                               โ
โ  โข run_deep_crawl()           โ
โ    โโ deep_crawl_site(url)    โ
โ    โโ ะทะฐะฟะธัั JSON             โ
โ                               โ
โ  โข launch_attack_plan()       โ
โ    โโ ะฒัะฟะพะปะฝะตะฝะธะต ะฐัะฐะบ         โ
โ    โโ ะฟัะพะฒะตัะบะฐ ัะพะบะตะฝะพะฒ        โ
โ                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   Honeypot Server (Flask)     โ
โ   ะพัะดะตะปัะฝัะน ะฟะพัะพะบ/ะฟัะพัะตัั     โ
โ   โโ ะฟัะธะฝะธะผะฐะตั HTTP-ะทะฐะฟัะพัั   โ
โ   โโ ะฟะธัะตั honeypot.log       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Honeypot Monitor (threading)  โ
โ   ะพัะดะตะปัะฝัะน ะฟะพัะพะบ             โ
โ   โโ ัะปะตะดะธั ะทะฐ honeypot.log   โ
โ   โโ ะธะทะฒะปะตะบะฐะตั payloads       โ
โ   โโ ะฟะธัะตั JSONL ัะพะฑััะธะน      โ
โ   โโ ะทะฐะฟััะบะฐะตั Mutator        โ
โ   โโ Instant-Attack Engine    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ThreatConnector               โ
โ   ัะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะฐั ัะธะฝะฐ       โ
โ   โโ ะฟัะธะฝะธะผะฐะตั ัะพะฑััะธั        โ
โ   โโ ะฟะตัะตะดะฐัั ะฒ Threat Intel  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

################################### ะะฐัะฐะผะตััั ัะธะทะธัะตัะบะพะณะพ ัะตัะฒะตัะฐ ##################

ะะพั ะฟัะธะผะตั ะฟะปะฐะฝะฐ ัะฑะพัะบะธ ัะธะทะธัะตัะบะพะณะพ ัะตัะฒะตัะฐ ััะตะดะฝะตะณะพ ััะพะฒะฝั ัะฟะตัะธะฐะปัะฝะพ ะฟะพะด ัะฒะพะน ะฟัะพะตะบั XSS Security GUI โ ััะพะฑั ะพะฝ ััะฝัะป ะผะฝะพะณะพะฟะพัะพัะฝัะน ะบัะฐัะปะธะฝะณ, ะฐะฝะฐะปะธะท XSS/CSRF/SQLi ะธ ััะฐะฝะตะฝะธะต ะปะพะณะพะฒ ะฑะตะท ะพะณัะฐะฝะธัะตะฝะธะน:

๐ฅ๏ธ ะะพะฝัะธะณััะฐัะธั ัะตัะฒะตัะฐ (Proโััะพะฒะตะฝั)
| ะะพะผะฟะพะฝะตะฝั | ะะพะดะตะปั/ะฒะฐัะธะฐะฝั                         | ะะฑะพัะฝะพะฒะฐะฝะธะต                        | 
| CPU       | AMD Ryzen 9 7950X (16 ัะดะตั, 32 ะฟะพัะพะบะฐ) |ะะฝะพะณะพะฟะพัะพัะฝัะน ะบัะฐัะปะธะฝะณ ะธ ะฐะฝะฐะปะธะทะฐัะพั |
|           | ะธะปะธ Intel Xeon Silver 4310 (12 ัะดะตั)   |ััะตะฑััั ะฟะฐัะฐะปะปะตะปัะฝัั ะฒััะธัะปะตะฝะธะน     |
|           |                                        |                                    |
| RAM       | 64 ะะ DDR5 (ะธะปะธ DDR4 ECC ะดะปั Xeon)     |ะะปั ัะฐะฑะพัั GUI, ะบัะฐัะปะตัะฐ, ะะ ะธ honey| 
| SSD       | 2ะขะ NVMe(Samsung 990Pro/WD BlackSN850X)| ะััะพะบะฐั ัะบะพัะพััั ะทะฐะฟะธัะธ/ััะตะฝะธั ะดะปั | 
|(ะพัะฝะพะฒะฝะพะน) |                                        | ะปะพะณะพะฒ ะธ ะฑะฐะทั ะฟะตะนะปะพะฐะดะพะฒ             |
|HDD(ะฐััะธะฒ) | 4 ะขะ SATA (Seagate IronWolf / WD Red) | ะะปั ััะฐะฝะตะฝะธั ััะฐััั ะปะพะณะพะฒ, ะพััััะพะฒ ะธ ัะตะทะตัะฒะฝัั ะบะพะฟะธะน | 
| ะกะตัั      | 1GbE ะฒัััะพะตะฝะฝัะน ะฐะดะฐะฟัะตั + ะพะฟัะธั 10GbE (Intel X550) | ะะปั honeypotโัะตัะฒะตัะฐ ะธ ะฑััััะพะน ะฟะตัะตะดะฐัะธ ะปะพะณะพะฒ | 
| ะะพัะฟัั    | ะกะตัะฒะตัะฝัะน ะบะพัะฟัั 4U ะธะปะธ ATX ั ัะพัะพัะธะผ  | ะะพะดะดะตัะถะบะฐ ะดะปะธัะตะปัะฝะพะน ัะฐะฑะพัั 24/7 | 
| ะะปะพะบ      |  ะพัะปะฐะถะดะตะฝะธะตะผ                           |                                  |
|ะฟะธัะฐะฝะธั    | 750โ850W Platinum (Seasonic / Corsair) | ะะฐะดัะถะฝะพััั ะธ ัะฝะตัะณะพัััะตะบัะธะฒะฝะพััั | 
|ะัะปะฐะถะดะตะฝะธะต | Noctua NHโU14S ะธะปะธ ะถะธะดะบะพััะฝะฐั ัะธััะตะผะฐ   | ะกัะฐะฑะธะปัะฝะพััั ะฟัะธ ะฝะฐะณััะทะบะต | 
| UPS       | APC SmartโUPS 1500VA                    | ะะฐัะธัะฐ ะพั ะฟะตัะตะฑะพะตะฒ ะฟะธัะฐะฝะธั | 



๐ฐ ะกัะพะธะผะพััั (ะพัะธะตะฝัะธัะพะฒะพัะฝะพ)
- CPU: ~$600โ700
- RAM 64 ะะ: ~$250โ300
- SSD 2 ะขะ NVMe: ~$200โ250
- HDD 4 ะขะ: ~$100โ120
- ะะฐัะตัะธะฝัะบะฐั ะฟะปะฐัะฐ (ัะตัะฒะตัะฝะฐั/ัะฐะฑะพัะฐั ััะฐะฝัะธั): ~$250โ350
- ะะพัะฟัั + ะพัะปะฐะถะดะตะฝะธะต: ~$200โ300
- ะะปะพะบ ะฟะธัะฐะฝะธั: ~$150โ200
- UPS: ~$300โ400
๐ ะัะพะณะพ: ~$2,200โ2,500 ะทะฐ ะฟะพะปะฝัะน ัะตัะฒะตั ยซะฟะพะด ะบะปััยป.

๐ ะญะบัะฟะปัะฐัะฐัะธั
- ะญะปะตะบััะธัะตััะฒะพ: ~250โ350 ะั ะฟัะธ ะฝะฐะณััะทะบะต โ ~$25โ40/ะผะตั.
- ะะฝัะตัะฝะตั: ะฒัะดะตะปะตะฝะฝัะน ะบะฐะฝะฐะป ั ัะธะบัะธัะพะฒะฐะฝะฝัะผ IP (~$10โ20/ะผะตั).
- ะะฑัะปัะถะธะฒะฐะฝะธะต: ัะตะณัะปััะฝะฐั ัะธััะบะฐ, ะพะฑะฝะพะฒะปะตะฝะธั ะะก ะธ ะผะพะฝะธัะพัะธะฝะณ.

๐ ะัะฒะพะด
ะขะฐะบะพะน ัะตัะฒะตั ะพะฑะตัะฟะตัะธั:
- ััะฐะฑะธะปัะฝัั ัะฐะฑะพัั GUI ะธ ะบัะฐัะปะตัะฐ,
- ััะฐะฝะตะฝะธะต ะฑะพะปััะธั ะปะพะณะพะฒ ะธ ะพััััะพะฒ,
- ะฒะพะทะผะพะถะฝะพััั ะทะฐะฟััะบะฐัั honeypotโัะตัะฒะธัั ะธ ะผะฝะพะณะพะฟะพัะพัะฝัะต ะฐัะฐะบะธ,
- ะทะฐะฟะฐั ะผะพัะฝะพััะธ ะฝะฐ ะฑัะดััะตะต ัะฐััะธัะตะฝะธะต.

ะฏ ะผะพะณั ัะฐัะฟะธัะฐัั ััะตะผั ัะฐะทะฒััััะฒะฐะฝะธั ัะฒะพะตะณะพ ะฟัะพะตะบัะฐ ะฝะฐ ััะพะผ ัะตัะฒะตัะต 
(ะบะฐะบะฐั ะะก, ะบะฐะบ ะฝะฐัััะพะธัั ะฒะธัััะฐะปัะฝัะต ะพะบััะถะตะฝะธั, ะฑะฐะทั ะธ ะปะพะณะธ), ััะพะฑั ั ัะตะฑั 
ะฑัะป ะณะพัะพะฒัะน ะฟะปะฐะฝ ัััะฐะฝะพะฒะบะธ. ะฅะพัะตัั, ััะพะฑั ั ัะพะฑัะฐะป ัะฐะบัั ััะตะผั?

โ๏ธ ะะก ะธ ะฑะฐะทะพะฒะฐั ะฝะฐัััะพะนะบะฐ
โข 	ะะก: Ubuntu Server 22.04 LTS (ััะฐะฑะธะปัะฝะฐั, ะฟะพะดะดะตัะถะบะฐ Python ะธ GUIโะฑะธะฑะปะธะพัะตะบ).
โข 	ะะฐะบะตัั: , , , ,  (ะดะปั ะบะพะฝัะตะนะฝะตัะธะทะฐัะธะธ ะพัะดะตะปัะฝัั ะผะพะดัะปะตะน).
โข 	ะะตะทะพะฟะฐัะฝะพััั:
โข 	ะะฐัััะพะธัั  (firewall) โ ะพัะบัััั ัะพะปัะบะพ SSH (22), ะฒะตะฑโะฟะพัั (80/443), honeypotโะฟะพัั.
โข 	ะะบะปััะธัั ะฐะฒัะพะผะฐัะธัะตัะบะธะต ะพะฑะฝะพะฒะปะตะฝะธั ().
โข 	ะะฐัััะพะธัั Fail2Ban ะดะปั ะทะฐัะธัั ะพั ะฑััััะพััะฐ.

๐งฑ ะะฐะทะฒััััะฒะฐะฝะธะต ะฟัะพะตะบัะฐ
1. 	ะกะพะทะดะฐะฝะธะต ะพะบััะถะตะฝะธั

2. 	ะะฐะฟััะบ GUI ะธ ัะตัะฒะธัะพะฒ
โข 	ะัะฝะพะฒะฝะพะน GUI: 
โข 	ะัะฐัะปะตั: 
โข 	Honeypot: 
3. 	ะะพะณะธ ะธ ะพััััั
โข 	ะัะต ะปะพะณะธ ัะพััะฐะฝััััั ะฒ .
โข 	ะะฐัััะพะธัั ัะพัะฐัะธั ะปะพะณะพะฒ ัะตัะตะท .
โข 	ะััััั (PDF/TXT) ััะฐะฝะธัั ะฝะฐ ะพัะดะตะปัะฝะพะผ HDD (ะฐััะธะฒ).

๐ ะฅัะฐะฝะตะฝะธะต ะดะฐะฝะฝัั
โข 	SSD (2 ะขะ NVMe): ะฐะบัะธะฒะฝัะต ะปะพะณะธ, ะฑะฐะทะฐ ะฟะตะนะปะพะฐะดะพะฒ, ะฒัะตะผะตะฝะฝัะต ัะฐะนะปั.
โข 	HDD (4 ะขะ): ะฐััะธะฒะฝัะต ะพััััั, ััะฐััะต ะปะพะณะธ, ัะตะทะตัะฒะฝัะต ะบะพะฟะธะธ.
โข 	ะะฐัััะพะธัั ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต ะปะพะณะพะฒ ั SSD โ HDD ัะฐะท ะฒ ะฝะตะดะตะปั (cron + rsync).

๐ฐ๏ธ ะกะตัะตะฒัะต ัะตัะฒะธัั
โข 	Honeypotโัะตัะฒะตั ัะปััะฐะตั ะพัะดะตะปัะฝัะน ะฟะพัั (ะฝะฐะฟัะธะผะตั, 8080).
โข 	ะะฐัััะพะธัั ะผะพะฝะธัะพัะธะฝะณ ัะตัะตะท  ะดะปั ะฝะฐะณััะทะบะธ CPU/RAM ะธ ะฐะบัะธะฒะฝะพััะธ honeypot.
โข 	ะะบะปััะธัั IDS/IPS (ะฝะฐะฟัะธะผะตั, Suricata) ะดะปั ะฐะฝะฐะปะธะทะฐ ัะตัะตะฒะพะณะพ ััะฐัะธะบะฐ.

๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะฐะดะผะธะฝะธัััะธัะพะฒะฐะฝะธะต
โข 	Grafana Dashboard: ะฒะธะทัะฐะปะธะทะฐัะธั ะฐัะฐะบ, ัะพะบะตะฝะพะฒ, ัะพะฑััะธะน honeypot.
โข 	Prometheus: ัะฑะพั ะผะตััะธะบ (CPU, RAM, ัะตัั).
โข 	Alertmanager: ัะฒะตะดะพะผะปะตะฝะธั ะฝะฐ eโmail/Telegram ะฟัะธ ะบัะธัะธัะตัะบะธั ัะพะฑััะธัั.

๐ฐ ะญะบัะฟะปัะฐัะฐัะธะพะฝะฝัะต ัะฐััะพะดั
โข 	ะญะปะตะบััะธัะตััะฒะพ: ~30โ40$/ะผะตั ะฟัะธ ะบััะณะปะพัััะพัะฝะพะน ัะฐะฑะพัะต.
โข 	ะะฝัะตัะฝะตั: ะฒัะดะตะปะตะฝะฝัะน ะบะฐะฝะฐะป ั ัะธะบัะธัะพะฒะฐะฝะฝัะผ IP (~15โ20$/ะผะตั).
โข 	ะะฑัะปัะถะธะฒะฐะฝะธะต (UPS, ะพัะปะฐะถะดะตะฝะธะต): ~100$/ะณะพะด.

๐ ะัะฒะพะด
ะขะฐะบะพะน ัะตัะฒะตั ะฟะพะทะฒะพะปะธั:
โข 	ะะฐะฟััะบะฐัั ะบัะฐัะปะตั ะธ ะฐะฝะฐะปะธะทะฐัะพัั ะฟะฐัะฐะปะปะตะปัะฝะพ ะฑะตะท ะปะฐะณะพะฒ.
โข 	ะฅัะฐะฝะธัั ะฑะพะปััะธะต ะผะฐััะธะฒั ะปะพะณะพะฒ ะธ ะพััััะพะฒ.
โข 	ะะฐะฑะพัะฐัั ะบะฐะบ ะฟะพะปะฝะพัะตะฝะฝะฐั ะปะฐะฑะพัะฐัะพัะธั ะดะปั ัะตััะธัะพะฒะฐะฝะธั XSS/CSRF/SQLi.
โข 	ะะพะดะดะตัะถะธะฒะฐัั honeypotโัะตัะฒะธัั ะธ ะผะพะฝะธัะพัะธะฝะณ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ.
=======================================================================================================================

ะัััะฐั ะธะดะตั โ ะดะฐะฒะฐะน ัะดะตะปะฐะตะผ ััะพ ะฟะพโะฒะทัะพัะปะพะผั: ะพัะดะตะปัะฝัะน MLโะผะพะดัะปั + ะธะฝัะตะณัะฐัะธั ะฒ ะบัะฐัะปะตั.

1. ะะฐัะตะผ MLโะบะปะฐััะธัะธะบะฐัะธั ัััะฐะฝะธั
ะงัะพ ััะพ ะดะฐัั:
- login / auth:
- ะฟัะธะพัะธัะธะทะฐัะธั XSS/CSRF/credentialโstuffing
- ะพัะดะตะปัะฝัะต payloadโั ะดะปั ัะพัะผ ะปะพะณะธะฝะฐ
- admin:
- ะฟะพะฒััะตะฝะฝัะน ะฟัะธะพัะธัะตั, ะฐะณัะตััะธะฒะฝัะน ััะทะทะธะฝะณ
- ะพัะดะตะปัะฝัะต ะฐะปะตััั ะฒ Threat Intel
- api:
- ััะธะปะตะฝะฝัะน ะฐะฝะฐะปะธะท JSON, ัะพะบะตะฝะพะฒ, ะบะปััะตะน
- ะฐะฒัะพะณะตะฝะตัะฐัะธั APIโะบะฐััั ะดะปั ะดะฐะปัะฝะตะนัะตะณะพ ัะตััะธัะพะฒะฐะฝะธั
- upload:
- ะพัะดะตะปัะฝัะต ะฟัะพะฒะตัะบะธ ะฝะฐ RCE / LFI / SVGโXSS / polyglot payloadโั
ะขะพ ะตััั ะบัะฐัะปะตั ะฟะตัะตััะฐัั ะฑััั โัะปะตะฟัะผโ ะธ ะฝะฐัะธะฝะฐะตั ะฟะพะฝะธะผะฐัั ัะธะฟ ัััะฐะฝะธัั ะธ ะฟะพะดัััะฐะธะฒะฐัั ัััะฐัะตะณะธั ะฐัะฐะบะธ.

2. ะััะธัะตะบัััะฐ MLโะผะพะดัะปั
ะกัััะบัััะฐ:
xss_security_gui/
  ml/
    __init__.py
    model/
      __init__.py
      page_classifier.py      # inference + lazy load
      train_page_classifier.py# ะพััะปะฐะนะฝ ะพะฑััะตะฝะธะต
      label_schema.json       # ัะฟะธัะพะบ ะบะปะฐััะพะฒ

3. ะคะพัะผะฐั ะพะฑััะฐััะตะน ะฒัะฑะพัะบะธ
ะคะฐะนะป, ะฝะฐะฟัะธะผะตั: xss_security_gui/ml/model/page_dataset.jsonl
ะะฐะถะดะฐั ัััะพะบะฐ:
{"text": "Login - MyApp\n<form>...</form>", "label": "login"}
{"text": "Admin dashboard /admin\nUsers list", "label": "admin"}
{"text": "GET /api/users\nSwagger docs", "label": "api"}
{"text": "Upload your file\n<input type='file'>", "label": "upload"}
{"text": "Just a blog page", "label": "other"}


ะะฐะบ ัะพะฑะธัะฐัั:
- ะฒะทััั ัะถะต ัะพััะฐะฝัะฝะฝัะต HTML ะธะท ะบัะฐัะปะตัะฐ (ะธะปะธ ะปะพะณะพะฒ)
- ะฒััะฐัะธัั:
- title, h1, formโัะตะบััั, buttonโัะตะบััั, URL
- ััะบะฐะผะธ ัะฐะทะผะตัะธัั 200โ1000 ะฟัะธะผะตัะพะฒ (ะผะธะบั login/admin/api/upload/other)
- ัะพััะฐะฝะธัั ะฒ page_dataset.jsonl.

4. ะกะบัะธะฟั ะพะฑััะตะฝะธั DistilBERT (train_page_classifier.py)
# xss_security_gui/ml/model/train_page_classifier.py
import json
from pathlib import Path
from typing import List, Dict

from datasets import Dataset
from transformers import (
    DistilBertTokenizerFast,
    DistilBertForSequenceClassification,
    Trainer,
    TrainingArguments,
)

BASE_DIR = Path(__file__).resolve().parent
DATA_PATH = BASE_DIR / "page_dataset.jsonl"
MODEL_OUT = BASE_DIR / "distilbert_page_classifier"
LABEL_SCHEMA_PATH = BASE_DIR / "label_schema.json"

LABELS = ["login", "admin", "api", "upload", "other"]
LABEL2ID = {l: i for i, l in enumerate(LABELS)}
ID2LABEL = {i: l for l, i in LABEL2ID.items()}


def load_dataset(path: Path) -> Dataset:
    rows: List[Dict] = []
    with path.open(encoding="utf-8") as f:
        for line in f:
            if not line.strip():
                continue
            obj = json.loads(line)
            text = obj.get("text", "").strip()
            label = obj.get("label", "other")
            if not text:
                continue
            if label not in LABEL2ID:
                label = "other"
            rows.append({"text": text, "label": LABEL2ID[label]})
    return Dataset.from_list(rows)


def main():
    ds = load_dataset(DATA_PATH)
    ds = ds.train_test_split(test_size=0.1)

    tokenizer = DistilBertTokenizerFast.from_pretrained("distilbert-base-uncased")

    def tokenize(batch):
        return tokenizer(
            batch["text"],
            truncation=True,
            padding="max_length",
            max_length=256,
        )

    ds_enc = ds.map(tokenize, batched=True)
    ds_enc = ds_enc.remove_columns(["text"])
    ds_enc.set_format("torch")

    model = DistilBertForSequenceClassification.from_pretrained(
        "distilbert-base-uncased",
        num_labels=len(LABELS),
        id2label=ID2LABEL,
        label2id=LABEL2ID,
    )

    args = TrainingArguments(
        output_dir=str(MODEL_OUT),
        num_train_epochs=3,
        per_device_train_batch_size=8,
        per_device_eval_batch_size=8,
        evaluation_strategy="epoch",
        save_strategy="epoch",
        logging_steps=50,
        learning_rate=5e-5,
        weight_decay=0.01,
        load_best_model_at_end=True,
        metric_for_best_model="eval_loss",
    )

    trainer = Trainer(
        model=model,
        args=args,
        train_dataset=ds_enc["train"],
        eval_dataset=ds_enc["test"],
        tokenizer=tokenizer,
    )

    trainer.train()
    model.save_pretrained(MODEL_OUT)
    tokenizer.save_pretrained(MODEL_OUT)

    with LABEL_SCHEMA_PATH.open("w", encoding="utf-8") as f:
        json.dump({"labels": LABELS}, f, indent=2, ensure_ascii=False)


if __name__ == "__main__":
    main()

๎ท๎ท
ะญัะพั ัะบัะธะฟั ะทะฐะฟััะบะฐะตััั ะพะดะธะฝ ัะฐะท ะพััะปะฐะนะฝ, ะผะพะดะตะปั ัะพััะฐะฝัะตััั ะฒ xss_security_gui/ml/model/distilbert_page_classifier/.

5. Inferenceโะผะพะดัะปั (page_classifier.py)
# xss_security_gui/ml/model/page_classifier.py
from __future__ import annotations
import json
from pathlib import Path
from functools import lru_cache
from typing import Literal, Dict, Any

import torch
from transformers import (
    DistilBertTokenizerFast,
    DistilBertForSequenceClassification,
)

BASE_DIR = Path(__file__).resolve().parent
MODEL_DIR = BASE_DIR / "distilbert_page_classifier"
LABEL_SCHEMA_PATH = BASE_DIR / "label_schema.json"

PageLabel = Literal["login", "admin", "api", "upload", "other"]


@lru_cache(maxsize=1)
def _load_label_schema() -> Dict[int, str]:
    try:
        with LABEL_SCHEMA_PATH.open(encoding="utf-8") as f:
            obj = json.load(f)
        labels = obj.get("labels") or ["login", "admin", "api", "upload", "other"]
    except Exception:
        labels = ["login", "admin", "api", "upload", "other"]
    return {i: l for i, l in enumerate(labels)}


@lru_cache(maxsize=1)
def _load_model():
    id2label = _load_label_schema()
    label2id = {v: k for k, v in id2label.items()}

    tokenizer = DistilBertTokenizerFast.from_pretrained(str(MODEL_DIR))
    model = DistilBertForSequenceClassification.from_pretrained(
        str(MODEL_DIR),
        num_labels=len(id2label),
        id2label=id2label,
        label2id=label2id,
    )
    model.eval()
    device = "cuda" if torch.cuda.is_available() else "cpu"
    model.to(device)
    return tokenizer, model, device, id2label


def classify_page(text: str) -> Dict[str, Any]:
    """
    ะะปะฐััะธัะธะบะฐัะธั ัััะฐะฝะธัั:
    returns: {"label": "login", "score": 0.93}
    """
    if not text or not text.strip():
        return {"label": "other", "score": 0.0}

    tokenizer, model, device, id2label = _load_model()

    inputs = tokenizer(
        text,
        truncation=True,
        padding="max_length",
        max_length=256,
        return_tensors="pt",
    )
    inputs = {k: v.to(device) for k, v in inputs.items()}

    with torch.no_grad():
        outputs = model(**inputs)
        probs = torch.softmax(outputs.logits, dim=-1)[0]
        score, idx = torch.max(probs, dim=-1)
        label = id2label[int(idx)]
        return {"label": label, "score": float(score)}

๎ท๎ท

6. ะะฝัะตะณัะฐัะธั ะฒ crawler.py
6.1. ะะผะฟะพัั
ะะฒะตััั crawler.py:
from xss_security_gui.ml.model.page_classifier import classify_page


6.2. ะกะฑะพั ัะตะบััะฐ ะดะปั ะบะปะฐััะธัะธะบะฐัะธะธ
ะะฝัััะธ crawl_site, ะฟะพัะปะต ะฟะฐััะธะฝะณะฐ HTML (ะฟะพัะปะต soup = BeautifulSoup(...) ะธ ะธะทะฒะปะตัะตะฝะธั ัะพัะผ/ะบะฝะพะฟะพะบ/ัะตะบััะพะฒัั ัะปะตะผะตะฝัะพะฒ) ะดะพะฑะฐะฒะธะผ:
        # ... ะฟะพัะปะต ัะพะณะพ, ะบะฐะบ ัะพะฑัะฐะปะธ forms/buttons/selects/textareas/meta ...

        # ะกะพะฑะธัะฐะตะผ ัะตะบัั ะดะปั MLโะบะปะฐััะธัะธะบะฐัะธะธ
        try:
            title = (soup.title.string or "").strip() if soup.title else ""
        except Exception:
            title = ""

        headings = []
        for tag in soup.find_all(["h1", "h2", "h3"]):
            try:
                txt = (tag.get_text(" ", strip=True) or "").strip()
                if txt:
                    headings.append(txt)
            except Exception:
                continue

        form_texts = []
        for form in soup.find_all("form"):
            try:
                txt = form.get_text(" ", strip=True)
                if txt:
                    form_texts.append(txt[:300])
            except Exception:
                continue

        button_texts = []
        for btn in soup.find_all("button"):
            try:
                txt = btn.get_text(" ", strip=True)
                if txt:
                    button_texts.append(txt)
            except Exception:
                continue

        url_snippet = safe_url  # ัะถะต ะฝะพัะผะฐะปะธะทะพะฒะฐะฝะฝัะน URL

        ml_text_parts = [
            f"URL: {url_snippet}",
            f"TITLE: {title}",
            "HEADINGS: " + " | ".join(headings[:10]),
            "FORMS: " + " | ".join(form_texts[:5]),
            "BUTTONS: " + " | ".join(button_texts[:10]),
        ]
        ml_input_text = "\n".join(ml_text_parts)[:2000]

        try:
            ml_result = classify_page(ml_input_text)
            node["page_class"] = ml_result.get("label", "other")
            node["page_class_score"] = ml_result.get("score", 0.0)
        except Exception as e:
            node["page_class"] = "other"
            node["page_class_score"] = 0.0
            logger.debug("ML classification failed for %s: %s", safe_url, e)

๎ท๎ท
ะะฑัะฐัะธ ะฒะฝะธะผะฐะฝะธะต: ะทะดะตัั ั ะธัะฟะพะปัะทัั safe_url ะธ logger ะธะท ัะถะต ัััะตััะฒัััะตะณะพ ะบะพะดะฐ.

6.3. ะัะพะฑัะพั ะฒ Threat Intel
ะ report_threatintel ะดะพะฑะฐะฒะธะผ ะฟะพะปะต:
        page_class = node.get("page_class", "other")
        page_class_score = node.get("page_class_score", 0.0)

        safe_report = {
            "module": "crawler",
            "url": url,
            "page_class": page_class,
            "page_class_score": page_class_score,
            "forms_count": len(forms),
            "scripts": script_paths,
            "headers": safe_headers,
            "api_endpoints": api_endpoints[:200],
            "links_count": len(links),
            "meta": meta,
            "events": events[:100],
            "error": error,
        }



7. ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะบะปะฐััะฐ ัััะฐะฝะธัั ะฒ ะปะพะณะธะบะต
ะะฐะปััะต ัั ะผะพะถะตัั ัะถะต ะฒ ะดััะณะธั ะผะพะดัะปัั (FormFuzzer, Attack Engine) ะดะตะปะฐัั, ะฝะฐะฟัะธะผะตั:
- ะตัะปะธ node["page_class"] == "login" โ ะฒะบะปััะฐัั ัะฟะตัโpayloadโั
- ะตัะปะธ admin โ ะฟะพะฒััะฐัั ะฟัะธะพัะธัะตั
- ะตัะปะธ api โ ะดะพะฑะฐะฒะปััั ะฒ ะพัะดะตะปัะฝัะน ัะฟะธัะพะบ ะดะปั APIโัะฐะทะทะธะฝะณะฐ
- ะตัะปะธ upload โ ะทะฐะฟััะบะฐัั uploadโัะฐะทะทะตั.

ะัะปะธ ัะพัะตัั, ัะปะตะดัััะธะผ ัะฐะณะพะผ ะผะพะถะตะผ:
- ะฟัะธะดัะผะฐัั ะฟัะฐะฒะธะปะฐ ะดะปั ะบะฐะถะดะพะณะพ ะบะปะฐััะฐ (ััะพ ะธะผะตะฝะฝะพ ะดะตะปะฐัั ั login/admin/api/upload),
- ะดะพะฑะฐะฒะธัั ะฒ GUI ะพัะดะตะปัะฝัั ะบะพะปะพะฝะบั โะขะธะฟ ัััะฐะฝะธัั (ML)โ ะธ ัะธะปัััั ะฟะพ ะฝะตะผั.


