# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é exploit_tab.py

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `eval()` (—Å—Ç—Ä–æ–∫–∞ 1192)
**–ü—Ä–æ–±–ª–µ–º–∞:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```python
# ‚ùå –ü–õ–û–•–û
endpoint = eval(raw) if raw.startswith("{") else {"url": raw}
```
**–†–µ—à–µ–Ω–∏–µ:**
```python
# ‚úÖ –•–û–†–û–®–û
endpoint = ast.literal_eval(raw) if raw.startswith("{") else {"url": raw}
```

### 2. Race condition –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ (—Å—Ç—Ä–æ–∫–∞ 870)
**–ü—Ä–æ–±–ª–µ–º–∞:** `req_idx += 1` –Ω–µ –∞—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
```python
# ‚ùå –ü–õ–û–•–û
req_idx += 1
local_idx = req_idx
```
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `threading.Lock` –∏–ª–∏ `queue.Queue`

## üü° –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 3. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è URL
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤ 4+ –º–µ—Å—Ç–∞—Ö
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–Ω–µ—Å—Ç–∏ –≤ –º–µ—Ç–æ–¥:
```python
def _parse_endpoint(self, raw: str) -> dict:
    """–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä—è."""
    if not raw or raw == "‚Äî":
        raise ValueError("URL –Ω–µ —É–∫–∞–∑–∞–Ω")
    try:
        if raw.startswith("{"):
            endpoint = ast.literal_eval(raw)
        else:
            endpoint = {"url": raw}
        endpoint["url"] = normalize_url(endpoint["url"])
        return endpoint
    except (ValueError, SyntaxError) as e:
        raise ValueError(f"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å URL: {e}")
```

### 4. –ò–º–ø–æ—Ä—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç—Ä–æ–∫–∏ 470, 715, 1235, 1481
**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞

### 5. –•–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞:** 
- –°—Ç—Ä–æ–∫–∞ 763: `"https://gazprombank.ru/?search="`
- –°—Ç—Ä–æ–∫–∞ 814: `Semaphore(4)`
- –°—Ç—Ä–æ–∫–∞ 1490: `MAX_LEN = 5000`

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–Ω–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–∞:
```python
class ExploitTab:
    DEFAULT_TARGETS = []  # –ó–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    DEFAULT_CONCURRENCY = 4
    MAX_RESPONSE_LOG_LENGTH = 5000
```

### 6. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–ü—Ä–æ–±–ª–µ–º–∞:** `stop_xss_attack()` –∏ `stop_xss_attacks()` –¥–µ–ª–∞–ª–∏ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –£–¥–∞–ª—ë–Ω –¥—É–±–ª–∏–∫–∞—Ç `stop_xss_attacks()` - –º–µ—Ç–æ–¥ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è

### 7. –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–ü—Ä–æ–±–ª–µ–º–∞:** `send_request()`, `detect_sensitive_data()` –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –û–±–∞ –º–µ—Ç–æ–¥–∞ —É–¥–∞–ª–µ–Ω—ã - –æ–Ω–∏ –Ω–∏–≥–¥–µ –Ω–µ –≤—ã–∑—ã–≤–∞–ª–∏—Å—å –≤ –∫–æ–¥–µ

## üü¢ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 8. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–ª–∞—Å—Å –¥–µ–ª–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ (1674 —Å—Ç—Ä–æ–∫–∏, 46 –º–µ—Ç–æ–¥–æ–≤)
**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞:
- `ExploitTabUI` ‚Äî —Ç–æ–ª—å–∫–æ UI
- `XSSFuzzer` ‚Äî –ª–æ–≥–∏–∫–∞ —Ñ—É–∑–∑–∏–Ω–≥–∞
- `IDORTester` ‚Äî –ª–æ–≥–∏–∫–∞ IDOR-—Ç–µ—Å—Ç–æ–≤
- `PayloadManager` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ payload'–∞–º–∏
- `ReportExporter` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 9. –í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
```python
# –í –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å
class ExploitConstants:
    LOGS_DIR = "logs"
    DEFAULT_TIMEOUT = 8.0
    DEFAULT_RATE_LIMIT = 1.0
    DEFAULT_INTERVAL = 1.0
    MAX_VARIANTS_PER_PAYLOAD = 20
    RESPONSE_LOG_CAP = 5000
```

### 10. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
```python
# ‚ùå –ü–õ–û–•–û
except Exception:
    pass

# ‚úÖ –•–û–†–û–®–û
except (ValueError, KeyError) as e:
    self.log(f"[‚ö†Ô∏è] –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: {e}")
except requests.RequestException as e:
    self.log(f"[‚ùå] –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞: {e}")
except Exception as e:
    self.log(f"[‚ùå] –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
    raise  # –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ
```

### 11. –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é
```python
from typing import Optional, Dict, List, Tuple

def get_selected_url(self) -> str:
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç URL –∏–∑ UI."""
    # ...

def get_timeout_rate(self) -> Tuple[float, float]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (timeout, rate_limit)."""
    # ...
```

### 12. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π logger:
```python
import logging

logger = logging.getLogger(__name__)

def log(self, text: str, level: str = "info"):
    """–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è."""
    ts = datetime.datetime.now().strftime("[%H:%M:%S]")
    msg = f"{ts} {text}"
    
    if hasattr(self, "log_box") and self.log_box:
        self.log_box.insert("end", msg + "\n")
        self.log_box.see("end")
    
    getattr(logger, level)(text)
```

## üìã –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
1. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å `eval()` –Ω–∞ `ast.literal_eval()`
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å race condition —Å `req_idx`
3. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ –¥—É–±–ª–∏—Ä—É—é—â—É—é—Å—è –ª–æ–≥–∏–∫—É –∏–∑–≤–ª–µ—á–µ–Ω–∏—è URL

### –§–∞–∑–∞ 2: –£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
4. ‚è≥ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ –Ω–∞—á–∞–ª–æ (—á–∞—Å—Ç–∏—á–Ω–æ - –¥–æ–±–∞–≤–ª–µ–Ω—ã TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)
5. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ safety config)
6. ‚úÖ –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –º–µ—Ç–æ–¥–æ–≤ (stop_xss_attacks —É–¥–∞–ª—ë–Ω)
7. ‚úÖ –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã (send_request, detect_sensitive_data —É–¥–∞–ª–µ–Ω—ã)

### –§–∞–∑–∞ 3: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
8. ‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç—å –∫–ª–∞—Å—Å –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
9. ‚úÖ –£–ª—É—á—à–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é
10. ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
11. ‚úÖ –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîß –ë—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å—Ä–∞–∑—É)

1. **–°—Ç—Ä–æ–∫–∞ 1192:** –ó–∞–º–µ–Ω–∏—Ç—å `eval()` ‚Üí `ast.literal_eval()`
2. **–°—Ç—Ä–æ–∫–∞ 763:** –£–±—Ä–∞—Ç—å —Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π URL –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º
3. **–°—Ç—Ä–æ–∫–∞ 1344:** –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç `stop_xss_attacks()`
4. **–°—Ç—Ä–æ–∫–∏ 1078, 1088:** –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã –∏–ª–∏ –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ deprecated
5. **–°—Ç—Ä–æ–∫–∞ 315:** –£–±—Ä–∞—Ç—å –ø—É—Å—Ç–æ–π `except: pass` –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

